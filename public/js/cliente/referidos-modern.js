class ReferidosManager{constructor(){this.init()}init(){this.setupCopyLink();this.setupShareButtons();this.setupAnimations()}setupCopyLink(){const copyBtn=document.getElementById('copyLinkBtn');const linkInput=document.getElementById('linkReferido');if(copyBtn&&linkInput){copyBtn.addEventListener('click',()=>{linkInput.select();linkInput.setSelectionRange(0,99999);navigator.clipboard.writeText(linkInput.value).then(()=>{this.showCopiedNotification();this.updateCopyButton(copyBtn)}).catch(err=>{console.error('Error al copiar:',err);this.showToast('Error al copiar el link','error')})})}}updateCopyButton(btn){const originalHTML=btn.innerHTML;btn.innerHTML='<i class="bi bi-check-circle-fill"></i> ¡Copiado!';btn.style.background='linear-gradient(135deg, #10b981, #059669)';setTimeout(()=>{btn.innerHTML=originalHTML;btn.style.background=''},2000)}showCopiedNotification(){const notification=document.createElement('div');notification.className='copied-notification';notification.innerHTML='<i class="bi bi-check-circle-fill"></i><span>Link copiado al portapapeles</span>';document.body.appendChild(notification);setTimeout(()=>{notification.style.opacity='0';setTimeout(()=>notification.remove(),300)},3000)}setupShareButtons(){const whatsappBtn=document.getElementById('shareWhatsAppBtn');const facebookBtn=document.getElementById('shareFacebookBtn');const twitterBtn=document.getElementById('shareTwitterBtn');const linkInput=document.getElementById('linkReferido');if(whatsappBtn&&linkInput){whatsappBtn.addEventListener('click',()=>{const link=linkInput.value;const text=encodeURIComponent(`¡Hola! Te invito a registrarte en nuestra tienda. Usa mi link de referido: ${link}`);window.open(`https://wa.me/?text=${text}`,'_blank')})}if(facebookBtn&&linkInput){facebookBtn.addEventListener('click',()=>{const link=linkInput.value;window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(link)}`,'_blank','width=600,height=400')})}if(twitterBtn&&linkInput){twitterBtn.addEventListener('click',()=>{const link=linkInput.value;const text=encodeURIComponent('¡Únete a esta increíble tienda!');window.open(`https://twitter.com/intent/tweet?url=${encodeURIComponent(link)}&text=${text}`,'_blank','width=600,height=400')})}}setupAnimations(){const observerOptions={threshold:.1,rootMargin:'0px 0px -50px 0px'};const observer=new IntersectionObserver((entries)=>{entries.forEach(entry=>{if(entry.isIntersecting){entry.target.classList.add('fade-in-up')}})},observerOptions);document.querySelectorAll('.stat-card, .link-card, .referidos-table-container').forEach((el,index)=>{el.style.animationDelay=`${index*.1}s`;observer.observe(el)})}showToast(message,type='info'){const toast=document.createElement('div');toast.className=`toast toast-${type}`;toast.innerHTML=`<i class="bi bi-${type==='success'?'check-circle-fill':type==='error'?'x-circle-fill':'info-circle-fill'}"></i><span>${message}</span>`;document.body.appendChild(toast);setTimeout(()=>{toast.style.opacity='0';setTimeout(()=>toast.remove(),300)},3000)}}document.addEventListener('DOMContentLoaded',()=>{new ReferidosManager()});function verDetalle(referidoId){window.location.href=`/cliente/referidos/${referidoId}`}
